CREATE DATABASE IF NOT EXISTS `svt` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE `svt`;
CREATE TABLE IF NOT EXISTS users (id BIGINT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(64) NOT NULL UNIQUE, password_hash VARCHAR(255) NOT NULL, role ENUM('admin','officer') NOT NULL DEFAULT 'officer', created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE IF NOT EXISTS blacklist (id BIGINT AUTO_INCREMENT PRIMARY KEY, plate_no VARCHAR(20) NOT NULL, reason VARCHAR(255) NULL, is_active TINYINT(1) NOT NULL DEFAULT 1, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, UNIQUE KEY uix_plate (plate_no)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE IF NOT EXISTS detections (id BIGINT AUTO_INCREMENT PRIMARY KEY, image_mime VARCHAR(64) NULL, image_blob LONGBLOB NULL, plate_text VARCHAR(32) NULL, is_blacklisted TINYINT(1) NOT NULL DEFAULT 0, matched_blacklist_id BIGINT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, INDEX idx_plate (plate_text)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE TABLE IF NOT EXISTS public_reports (id BIGINT AUTO_INCREMENT PRIMARY KEY, reporter_name VARCHAR(64) NULL, reporter_phone VARCHAR(32) NULL, plate_no VARCHAR(20) NOT NULL, location VARCHAR(255) NULL, note TEXT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;